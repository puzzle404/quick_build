<%= render Constructors::Projects::SectionsNavComponent.new(project: @project, current_section: :materials) %>

<div class="mt-6 space-y-6">
  <%= render 'shared/section_header', title: 'Listas de materiales', subtitle: 'Organizá los insumos de la obra, cargalos manualmente o subí archivos para procesarlos más adelante.' do %>
    <% if policy(@project).manage_materials? %>
      <%= render Ui::ButtonComponent.new(label: 'Nueva lista', path: new_constructors_project_material_list_path(@project)) %>
    <% end %>
  <% end %>

  <%= render Ui::SearchPanelComponent.new(
        form_action: constructors_project_material_lists_path(@project),
        query_param: :q,
        query_value: @query,
        placeholder: 'Buscar listas o notas...',
        title: 'Buscador de listas',
        date_filters: {
          enabled: true,
          from_param: :from_date,
          to_param: :to_date,
          from_value: @from_date,
          to_value: @to_date,
          from_label: 'Actualizadas desde',
          to_label: 'Actualizadas hasta'
        }
      ) %>

  <div class="grid gap-4 sm:grid-cols-2">
    <% @material_lists.each do |list| %>
      <%= render Constructors::Projects::MaterialLists::CardComponent.new(project: @project, material_list: list) %>
    <% end %>

    <% if @material_lists.empty? %>
      <div class="rounded-2xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-500">
        Todavía no generaste listas de materiales para esta obra. Arrancá creando una, o subí un archivo para procesarlo.
      </div>
    <% end %>
  </div>
</div>
