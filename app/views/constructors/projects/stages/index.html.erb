<%= render Constructors::Projects::SectionsNavComponent.new(project: @project, current_section: :planning) %>

<div class="mt-6 space-y-6">
  <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
    <div>
      <h1 class="text-2xl font-semibold text-slate-900">Planificación de la obra</h1>
      <p class="text-sm text-slate-500">Organizá las etapas principales, definí subetapas y mantené la documentación al día.</p>
    </div>
    <div class="flex flex-wrap items-center gap-3">
      <%= render Ui::ButtonComponent.new(label: 'Aplicar plantilla base', path: apply_template_constructors_project_stages_path(@project), turbo_method: :post, variant: :secondary, size: :sm, turbo_confirm: '¿Quieres cargar la estructura sugerida? Las etapas existentes se conservarán.') %>
      <%= render Ui::ButtonComponent.new(label: 'Crear nueva etapa', path: new_constructors_project_stage_path(@project), size: :sm) %>
    </div>
  </div>

  <% if @stages.any? %>
    <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-3">
      <% @stages.each do |stage| %>
        <%= render Constructors::Projects::Stages::SummaryCardComponent.new(project: @project, stage: stage) %>
      <% end %>
    </div>
  <% else %>
    <div class="rounded-3xl border border-dashed border-slate-200 bg-white p-10 text-center">
      <h2 class="text-xl font-semibold text-slate-900">Todavía no cargaste etapas principales</h2>
      <p class="mt-2 text-sm text-slate-500">Podés iniciar con la plantilla sugerida o crear una etapa desde cero según el proceso de tu obra.</p>
      <div class="mt-6 flex flex-wrap justify-center gap-3">
        <%= render Ui::ButtonComponent.new(label: 'Aplicar plantilla base', path: apply_template_constructors_project_stages_path(@project), turbo_method: :post, variant: :secondary, size: :md, turbo_confirm: '¿Deseas cargar las etapas recomendadas?') %>
        <%= render Ui::ButtonComponent.new(label: 'Crear nueva etapa', path: new_constructors_project_stage_path(@project), size: :md) %>
      </div>
    </div>
  <% end %>
</div>
